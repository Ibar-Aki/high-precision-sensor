# 変わった視点レビュー（運用・現場重視）

作成日時: 2026-02-24 19:54:14 +09:00  
作成者: Codex＋GPT-5  
更新日: 2026-02-24

## 1. このレビューの視点

通常のバグ検出ではなく、以下を重視しています。

- 現場オペレータが誤操作しやすい箇所
- 実証試験時に「計測不能」になりやすい条件
- トラブル発生時に原因追跡しにくい設計

## 2. 現場導入で先に問題化しやすい点

### F1. 権限拒否時の復旧導線が「知っている人向け」

- 根拠: `assets/js/app.js:200-218`, `table-level/assets/js/app.js:153-163`
- 観察: 拒否時メッセージはあるが、現場手順書なしだと復旧手順が担当者依存になる。
- 現場リスク: 「アプリ不具合」と誤認され、実験中断が発生。
- 対策: 画面内に「Safariでの許可再設定手順」ボタンを常設（静的ヘルプで可）。

### F2. 2点キャリブレーションが一時トースト依存

- 根拠: `assets/js/modules/AppEventBinder.js:46-81`
- 観察: 重要操作（180度回転して再押下）がトースト文言中心で、現場では見逃しやすい。
- 現場リスク: 手順ミスで精度低下、再試行増加。
- 対策: ステップ表示UI（`1/2`, `2/2`）を固定表示し、現在状態を明示。

### F3. オフライン異常時の体験差がアプリ間で不一致

- 根拠: `sw.js:107-110`, `table-level/sw.js:92-97`
- 観察: 高精度傾斜計はプレーンテキスト `Offline`、机水平ガイドは専用 `offline.html` にフォールバック。
- 現場リスク: サポート時に「同じリポジトリなのに挙動が違う」混乱。
- 対策: オフライン異常画面を共通テンプレート化。

### F4. 終了イベントの扱いが分裂し、調査が難しい

- 根拠: `assets/js/modules/LifecycleManager.js:16-27`, `table-level/assets/js/app.js:141-145`
- 観察: 保存タイミング契約が統一されていない。
- 現場リスク: 「保存されたはずの設定が戻る」問題の再現が環境依存化。
- 対策: ライフサイクル設計を共通化し、検証観点（どのイベントで保存保証するか）を文書化。

### F5. 計測モード表示が技術語で、現場解釈にズレ

- 根拠: `assets/js/app.js:328-342`, `table-level/assets/js/app.js:348`
- 観察: `active/locking/measuring` は開発者には明確だが、非技術者には判断困難。
- 現場リスク: 「今どの状態で待つべきか」が統一されず、手順逸脱が起きる。
- 対策: 文言を運用語に置換（例: `計測中`, `安定化中`, `確定値`）。

## 3. 運用監査の観点で足りないもの

1. セッション監査ログ
- いつ開始し、どの設定で、どの理由で失敗したかが後追いできない。
- 追加候補: `settings snapshot + permission result + sensor availability` を1セッションJSONに保存。

2. 端末・ブラウザ属性の可視化
- 現場トラブル時に「この端末だけ再現するか」を即断できない。
- 追加候補: デバッグ画面で `UA, iOS version, PWA mode, permission state` を表示。

3. SOP（標準作業手順）との接続
- UIのままでは作業者教育が属人化しやすい。
- 追加候補: 起動前チェックリスト（水平基準面、ケース装着有無、端末向き）を組み込み。

## 4. 現場向け即効改善（低コスト）

1. 権限拒否時ヘルプ画面を追加（1画面）
2. 2点校正ステップを固定UI化（トースト依存を減らす）
3. オフライン失敗画面を両アプリで統一
4. モード文言を運用語に置換
5. セッションIDと最終状態コードを表示して問い合わせ時の伝達を標準化

## 5. 評価

- コード品質そのものは良好です。
- 一方で、現場導入の成功率を決めるのは「誤操作耐性」「障害時の復旧導線」「監査可能性」です。
- 次フェーズは、アルゴリズム改善より先に「運用事故を減らすUXと監査設計」を優先するのが合理的です。

