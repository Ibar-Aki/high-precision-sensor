# iPhone向け 高精度傾斜角センサー PWA 実装計画書
更新日: 2026-02-13

## 1. 文書目的

本計画書は、iPhone 内蔵センサーを用いた高精度傾斜角測定 PWA の実装方針、技術選定、検証方針を整理し、開発判断の根拠を明文化することを目的とする。

## 2. 推定作業時間

推定作業時間: 約8時間

## 3. 要件定義

| 項目 | 決定内容 |
|------|----------|
| 計測単位 | 度（°） |
| 計測軸 | 2軸（ピッチ: 前後、ロール: 左右） |
| 音声通知 | 前後左右の4方向を識別 |
| 音声モード | 常時モード / 閾値モード |
| 想定用途 | 設備据付時の傾斜確認 |
| 表示言語 | 日本語 |
| 配布方式 | GitHub Pages（HTTPS） |

## 4. 精度向上方針

| 手法 | 目的 |
|------|------|
| 1D カルマンフィルタ（2軸） | 観測ノイズを抑制し推定値を安定化 |
| 指数移動平均（EMA） | 高周波成分を平滑化 |
| キャリブレーション | オフセット誤差の補正 |
| デッドゾーン処理 | 微小変動の視覚的揺らぎ抑止 |
| 定周期描画更新 | 表示と計算負荷のバランス維持 |

## 5. 実装対象ファイル

| ファイル | 役割 |
|------|------|
| `index.html` | 画面構成、主要 UI コンポーネント、設定パネル |
| `style.css` | レイアウト、配色、状態表示スタイル |
| `app.js` | センサー処理、音声処理、UI 更新、設定永続化 |
| `manifest.json` | PWA メタ情報 |
| `sw.js` | オフラインキャッシュ制御 |

## 6. 検証方針

### 6.1 開発環境検証

- UI 表示崩れの有無
- 設定変更の反映と永続化
- Service Worker 登録可否
- キャッシュ資産整合性

### 6.2 実機検証（利用者作業）

- iOS Safari における権限許諾フロー
- 計測値追従性および静止安定性
- PWA インストールおよび起動性

## 7. 既知制約

- 絶対精度は端末個体差、設置条件、温度ドリフトの影響を受ける。
- HTTPS 以外では Service Worker を含む一部機能が制限される。
- DeviceOrientation API の提供品質はブラウザ実装に依存する。
